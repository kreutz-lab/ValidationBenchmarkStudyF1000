# This function summarizes the significance data.frame as generated by bs_DA2dataFrame
# e.g. in helper_4.x_dataToCompare2DF.R
#
# bs_summarizeDF("../Results_partReg/4.2_metaSPARSim_ZerosAdded_DA/DF.RDS",outFile="DF.summary.xlsx")
#
# res <- readRDS("../Results_partReg/4.2_metaSPARSim_ZerosAdded_DA/DF.RDS")
# res <- bs_summarizeDF(DF,outFile="DF.summary.xlsx")
# bs_summarizeDF("../Results/DF.RDS",outFile="DF.summary.xlsx")
# summary <- bs_summarizeDF(DFn,outFile="DFn.log")

bs_summarizeDF <- function(file_or_DF="DF.RDS",outFile=NULL){
  if(is.character(file_or_DF)){
    file <- file_or_DF
    comment <- paste0("Reading from ",file)
    DF <- readRDS(file)
    if(is.null(outFile)){
      outFile <- sub(".RDS",".summary.xlsx",file)
    }
  }else{
    comment = "data.frame provided as variable"
    file="data.frame"
    DF <- file_or_DF
  }
  
  if(!is.null(outFile))
    wb <- createWorkbook()
    
#  res <- list(description=paste0("file = ",comment))
  res <- list()
  for(col in names(DF)){
    if(!is.numeric(DF[,col])){
      tmp <- sort(table(DF[,col]))
      res[[col]] <- setNames(data.frame(as.numeric(tmp),row.names=names(tmp)),"Frequency")
    }else{
      
      res[[col]] <- setNames(data.frame(c(sum(DF[,col]==0,na.rm=T),
                               sum(is.na(DF[,col]),na.rm=T),
                               sum(!is.na(DF[,col]),na.rm=T),
                               sum(DF[,col]>0,na.rm=T)),
                               row.names=c("NumberOfZeros","NumberOfNA","NumberOfNotNA","NumberLargerZero")),
                               "Frequency")
    }
    
    if(!is.null(outFile)){
      openxlsx::addWorksheet(wb, col)
      openxlsx::writeData(wb, sheet=col, x=res[[col]],rowNames = T)
    }
    
  }
 
  if(!is.null(outFile))
    openxlsx::saveWorkbook(wb, outFile, overwrite = TRUE)
  return(res)
}